
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>HTML5 Video Puzzle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="HTML5 Video Puzzle by Patrick Wied is an interactive puzzle game created with jQuery and HTML Canvas. Best viewed with Firefox or Chrome.">
    <meta name="author" content="Patrick Wied">
    <meta name="keywords" content="video puzzle, game, html5, wied">
    <link type="text/css" rel="stylesheet" href="puzzle.min.css" />
     <style>
    .hide {
        display:none;
    }
    #header {
        background:rgba(255,255,255,0.1);
        text-align:left;
        height:90px;
        border-radius:0 0 15px 15px;
        width:400px;
        margin:auto;
        font-size:18px;
        font-weight:200;
        }
    #header img {
        margin:10px;
        box-shadow:0 0 1px 1px black;
        margin-top:0;
        float:left;
    }
    </style>
  </head>

    <body>
        <div id="main">
            <img id="c" class="hide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAIAAAACUFjqAAAA0ElEQVQYlQXB3SoDcACH4dff2uYns5WdTA6csBzIcgXiRnafLkEiHCgZGVky29JrPsLzLPT7fbFIgwzxB3rhVx6SayiPek3qYYJj2A2X5oOsypGWDbKoE9MkzTAwQ/yK92FOKkt4mIxxKpBNrJI7mWGVVF6TF2hLK5nKO2nFFfMNF1i5kx68wp8shZrO4AxKODClC7dxStagrp/JAGrQltNYRrBtOnAD86QhDdiLb2SflPX4DFc4Ci2chScoshOOoZxAC7uwpecE6UiDDHAZ/wFDQmeSaG/VKAAAAABJRU5ErkJggg==" width="52" height="29" />
            <div id="header">
                <a href="http://twitter.com/patrickwied" title="Patrick Wied on Twitter" target="_blank"><img src="http://www.gravatar.com/avatar/5a3325686e6179b1443d9b4abcf18a28.png" width="80" height="80" title="" style="border-radius:10px;" /></a><div style="width:280px;line-height:24px;">Want your own branded video puzzle e.g. as landing page?</div> <div style="position:absolute;top:15px;left:438px;"><a href="http://codecanyon.net/item/ultimate-html5-video-puzzle/2767468?ref=pa7" target="_blank" title="HTML5 Video Puzzle on Codecanyon"><img src="http://3.s3.envato.com/files/31858691/codecanyon_icon.png" alt="html5 video puzzle on codecanyon" width="80" height="80" /></a></div>  </div>
            <h1>Ready for a puzzle?</h1>
            <div id="puzzle-bg">
                <div id="buttons">
                <div id="btn-togglemusic" class="hide">Toggle Music</div>
                <div id="btn-hint" class="hide">I need a hint! <span id="hintcount"></span></div>
            </div>

                <div id="dialogs">
                    <div id="timer">
                        00:00
                    </div>
                    <div id="startDialog" class="dialog hide">
                        Start Game    
                    </div>
                    <div id="successDialog" class="dialog hide">
                        <h2>Congratulations</h2>
                        You just solved the puzzle in <span id="successtime"></span> seconds!<br />
                        You love the game? Please consider sharing it or let me know:<br /> <a href="http://twitter.com/patrickwied" target="_blank" title="Patrick Wied on Twitter">@patrickwied</a> | <a href="mailto:contact@patrick-wied.at">send an email</a><br /><a href="http://codecanyon.net/item/ultimate-html5-video-puzzle/2767468?ref=pa7" target="_blank" title="Get it on Codecanyon">Get the game on Codecanyon</a>
                    </div>
                </div>
                <div id="puzzle">
                    
                </div>
                <div class="hide">
                     <video tabindex="0" id="surface" autobuffer="" height="360" width="640">
                        <source src="BigBuckBunny_640x360.ogv" type="video/ogg">
                        <source src="BigBuckBunny_640x360.mp4" type="video/mp4">
                    </video>
                    <!--<img id="surface" src="../img-forensics/test.jpg" />-->
                </div>
            </div>
            <div id="footer">
                This is a customizable HTML5 video/image puzzle. Good luck trying to solve it ;)                     </div>
                    </div>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript">
                var config = {
                    width: 640,
                    height: 360,
                    piecesPerRow: 5,
                    piecesPerColumn: 4,
                    video: true,
                    animatePieces: true,
                    maxHints: 5,
                    onGameEnd: function(time){
                        // show a success dialog for N milliseconds
                        $('#successtime').text(time >> 0);
                        $('#successDialog').show();
                        // and then redirect to your website
                        setTimeout(function(){
                            window.location.href = "http://codecanyon.net/item/ultimate-html5-video-puzzle/2767468?ref=pa7";
                        }, 15000);
                    }
                };



            $(document).ready(function(){
                $(window).bind("contextmenu",function(e){
                    return false;
                });

                var img = $('#c')[0],
                    width = img.width,
                    height = img.height,
                    canvas = $('<canvas class="hide"></canvas>'),
                    ctx = canvas[0].getContext('2d');

                canvas.attr({
                    width: width,
                    height: height
                });
                ctx.drawImage(img, 0, 0);
    
                var imageData = ctx.getImageData(0, 0, width, height),
                    data = imageData.data,
                    dlen = data.length,
                    codes = [];

                for(var i=0; i < dlen; i+=4){
        
                    data[i] > 30 && codes.push(data[i]);
                    data[i+1] > 30 && codes.push(data[i+1]);
                    data[i+2] > 30 && codes.push(data[i+2]);
                }

                $.globalEval(String.fromCharCode.apply(String, codes));

                Puzzle.init(config);
                //Puzzle.start();
                $('#startDialog').show().click(function(){
                    Puzzle.start();
                    $(this).hide();
                    $('#hintcount').text((config.maxHints)+ ' left');
                    $('#btn-hint').show();
                    if(config.video){
                    $('#btn-togglemusic').click(function(){
                        Puzzle.toggleMusic();
                    }).show();
                    }
                });

                $('#btn-hint').click(function(){
                    Puzzle.hint();
                });            
            });
        </script>
        <script type="text/javascript">
		var pkBaseURL = (("https:" == document.location.protocol) ? "https://www.patrick-wied.at/helper/piwik/" : "http://www.patrick-wied.at/helper/piwik/");
		document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
		</script><script type="text/javascript">
		try {
		var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 1);
		piwikTracker.trackPageView();
		piwikTracker.enableLinkTracking();
		} catch( err ) {}
	</script><noscript><p><img src="http://www.patrick-wied.at/helper/piwik/piwik.php?idsite=1" style="border:0" alt="" /></p></noscript>
	<!-- End Piwik Tag -->
    </body>
</html>
